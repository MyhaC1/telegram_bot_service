# 🚀 Быстрый старт: Telegram Mini App

## Что это?

Теперь регистрация менеджеров происходит через **Telegram Mini App** — красивую веб-форму, которая открывается прямо в Telegram!

## ✅ Что уже готово

1. ✅ **WebApp форма** — `webapp/index.html`
2. ✅ **Обработчик в боте** — получает данные из WebApp
3. ✅ **Валидация** — проверка email, телефона, обязательных полей
4. ✅ **Адаптивный дизайн** — работает на любых устройствах
5. ✅ **Telegram тема** — автоматически подстраивается под тему Telegram

---

## 📋 Инструкция за 5 минут

### 1. Разместите WebApp на GitHub Pages

```powershell
# Перейдите в директорию проекта
cd C:\Users\user\Desktop\telegram_bot_service

# Инициализируйте git (если еще не сделано)
git init
git add .
git commit -m "Add Telegram Mini App"

# Создайте репозиторий на GitHub и подключите его
git remote add origin https://github.com/YOUR_USERNAME/telegram_bot_service.git
git branch -M main
git push -u origin main
```

**Затем на GitHub:**
1. Settings → Pages
2. Source: `main` branch, `/root` folder
3. Save
4. Подождите 2 минуты

Ваш WebApp будет доступен по адресу:
```
https://YOUR_USERNAME.github.io/telegram_bot_service/webapp/
```

### 2. Обновите конфигурацию

Откройте `.env` и замените:

```env
WEBAPP_URL=https://YOUR_USERNAME.github.io/telegram_bot_service/webapp/
```

### 3. Запустите бота

```powershell
python test_bot.py
```

### 4. Протестируйте

1. Откройте вашего Manager бота в Telegram
2. Отправьте `/start`
3. Нажмите кнопку **"📝 Зарегистрироваться"**
4. Заполните форму
5. Нажмите **"Отправить заявку"**

---

## 🎨 Локальный предпросмотр

Откройте в браузере:

```powershell
cd webapp
python -m http.server 8080
```

Затем: http://localhost:8080/demo.html

⚠️ **Важно**: Telegram API работает только внутри Telegram! Локально вы увидите только дизайн.

---

## 📱 Как это работает

```
┌─────────────┐
│ Пользователь│
│  открывает  │
│    бота     │
└──────┬──────┘
       │
       ▼
┌─────────────────────────┐
│  Бот показывает кнопку  │
│ "📝 Зарегистрироваться" │
└──────┬──────────────────┘
       │
       ▼
┌──────────────────────────┐
│  WebApp открывается      │
│  внутри Telegram         │
│  (форма регистрации)     │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│  Пользователь заполняет  │
│  ФИО, Email, Телефон,    │
│  Роль                    │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│  Нажимает "Отправить"    │
│  tg.sendData(json)       │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│  Бот получает данные     │
│  через handler           │
│  F.web_app_data          │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│  Создается               │
│  PendingRegistration     │
│  в БД                    │
└──────┬───────────────────┘
       │
       ▼
┌──────────────────────────┐
│  Уведомление             │
│  пользователю:           │
│  "Заявка отправлена!"    │
└──────────────────────────┘
```

---

## 🔧 Кастомизация

### Изменить дизайн

Откройте `webapp/index.html` и измените CSS в секции `<style>`.

### Добавить поля

1. Добавьте HTML поле в форму
2. Добавьте валидацию в JavaScript
3. Добавьте поле в `formData` объект
4. Обновите обработчик в `webapp.py`

### Изменить язык

Замените все текстовые строки в `index.html` на нужный язык.

---

## 📖 Дополнительные ресурсы

- 📄 [Полная инструкция по деплою](DEPLOY_WEBAPP.md)
- 🌐 [Telegram WebApp Docs](https://core.telegram.org/bots/webapps)
- 📚 [GitHub Pages](https://pages.github.com/)

---

## 🎯 Что дальше?

После регистрации через WebApp:
1. Админ видит заявку в Admin Bot (`/pending`)
2. Админ одобряет: `approve <id>`
3. Менеджер получает уведомление
4. Менеджер может работать с клиентами

---

Готово! 🎉
