# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –±–æ—Ç–æ–≤

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

**–°—Ç–∞—Ç—É—Å**: –ë–æ—Ç—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—Å—Ç–∏–ª–∏—Å—å!

### –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ –±–æ—Ç—ã:
- üì± **Manager Bot**: @patriot_man_bot (ID: 7620229163)
- üîß **Admin Bot**: @patriot_amd_bot (ID: 8191923162)

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQLite) –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ FastAPI —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É 8002
- ‚úÖ Polling –∞–∫—Ç–∏–≤–µ–Ω (–ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç Telegram)
- ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ):
- ‚ö†Ô∏è FastAPI `on_event` deprecated (–º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –Ω–∞ lifespan –ø–æ–∑–∂–µ)

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ:

```powershell
python test_bot.py
```

–ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç–µ–∫—É—â–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –µ–≥–æ!

---

### 2. –¢–µ—Å—Ç Manager Bot (@patriot_man_bot)

–û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ @patriot_man_bot

**–°—Ü–µ–Ω–∞—Ä–∏–π 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞**

```
/start
```
–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç: –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥

```
/register
```
–î–∞–ª–µ–µ –±–æ—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç:
1. –§–ò–û ‚Üí –≤–≤–µ–¥–∏—Ç–µ: `–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤`
2. Email ‚Üí –≤–≤–µ–¥–∏—Ç–µ: `ivan@example.com`
3. –¢–µ–ª–µ—Ñ–æ–Ω ‚Üí –≤–≤–µ–¥–∏—Ç–µ: `+79991234567`
4. –†–æ–ª—å ‚Üí –≤–≤–µ–¥–∏—Ç–µ: `senior`
5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –≤–≤–µ–¥–∏—Ç–µ: `–ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å`

‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –°–æ–æ–±—â–µ–Ω–∏–µ "–í–∞—à–∞ –∑–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É"

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î:**
```powershell
python -c "import asyncio; from app.db.models import PendingRegistration; from app.core.database import init_db, close_db; async def check(): await init_db(); items = await PendingRegistration.all(); print(f'Pending registrations: {len(items)}'); for i in items: print(f'- {i.name} ({i.email}) - {i.status}'); await close_db(); asyncio.run(check())"
```

---

### 3. –¢–µ—Å—Ç Admin Bot (@patriot_amd_bot)

**–í–ê–ñ–ù–û**: –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤—å—Ç–µ –≤–∞—à Telegram ID –≤ `.env`:

1. –£–∑–Ω–∞–π—Ç–µ —Å–≤–æ–π ID —É @userinfobot
2. –û—Ç–∫—Ä–æ–π—Ç–µ `.env` –∏ –∏–∑–º–µ–Ω–∏—Ç–µ:
```
ADMIN_TELEGRAM_IDS=–í–ê–®_TELEGRAM_ID
```
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

–û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ @patriot_amd_bot

```
/start
```
–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç (–µ—Å–ª–∏ –≤—ã –∞–¥–º–∏–Ω): –ú–µ–Ω—é –∞–¥–º–∏–Ω –±–æ—Ç–∞

```
/pending
```
‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –°–ø–∏—Å–æ–∫ pending —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–π —Å –∏—Ö –¥–∞–Ω–Ω—ã–º–∏

**–û–¥–æ–±—Ä–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏:**
```
approve 1
```
‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –°–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞—è–≤–∫–∞ #1 –æ–¥–æ–±—Ä–µ–Ω–∞"
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Manager Bot: "–í–∞—à–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–¥–æ–±—Ä–µ–Ω–∞!"
- –°–æ–∑–¥–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ —á–µ—Ä–µ–∑ API Gateway (–º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å, –µ—Å–ª–∏ Gateway –Ω–µ –∑–∞–ø—É—â–µ–Ω)

**–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏:**
```
reject 2 –Ω–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```
‚úÖ **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –°–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞—è–≤–∫–∞ #2 –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞"
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Manager Bot: "–í–∞—à–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞. –ü—Ä–∏—á–∏–Ω–∞: –Ω–µ–ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ API endpoints

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ curl:

```powershell
# Health check
curl http://localhost:8002/health

# Root endpoint
curl http://localhost:8002/
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ)

1. **API Gateway –Ω–µ –∑–∞–ø—É—â–µ–Ω** ‚Äî –∑–∞–ø—Ä–æ—Å—ã `create_manager()`, `get_manager()` —É–ø–∞–¥—É—Ç —Å –æ—à–∏–±–∫–æ–π
   - **–†–µ—à–µ–Ω–∏–µ**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ API Gateway –∏–ª–∏ –∑–∞–º–æ–∫–∞–π—Ç–µ –æ—Ç–≤–µ—Ç—ã

2. **Redis –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** ‚Äî FSM states —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ (—Å–±—Ä–æ—Å—è—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ)
   - **–†–µ—à–µ–Ω–∏–µ**: –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ Redis –∏–ª–∏ Docker Compose

3. **SQLite –±–∞–∑–∞** ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ñ–∞–π–ª `dev.db` –≤ —Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
   - **–†–µ—à–µ–Ω–∏–µ**: –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ PostgreSQL

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –º–µ–Ω–µ–¥–∂–µ—Ä–∞
2. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å approve/reject –∞–¥–º–∏–Ω–æ–º
3. ‚è≥ –ó–∞–ø—É—Å—Ç–∏—Ç—å API Gateway –¥–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
4. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤
5. ‚è≥ –î–æ–±–∞–≤–∏—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–∫–Ω–æ–ø–∫–∏ –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–∞)
6. ‚è≥ –ù–∞–ø–∏—Å–∞—Ç—å unit-—Ç–µ—Å—Ç—ã

---

## üìä –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–í—Å–µ –ª–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª—å. –ü—Ä–∏–º–µ—Ä:

```json
{
  "asctime": "2025-11-18 15:04:57",
  "levelname": "INFO",
  "name": "aiogram.dispatcher",
  "message": "Run polling for bot @patriot_man_bot"
}
```

–î–ª—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤ –∏–∑–º–µ–Ω–∏—Ç–µ –≤ `.env`:
```
LOG_LEVEL=DEBUG
```
